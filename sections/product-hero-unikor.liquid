{% comment %} Exact Unikor product hero: left = gallery + badge + AS SEEN ON + thumbs; right = title, stars, price, bullets, testimonial, note, buy more, CTA, payments {% endcomment %}
<section class="unikor-product-hero">
  <div class="page-width unikor-product-hero__container">
    <div class="unikor-product-hero__media">
      <div class="unikor-product-hero__main-wrap">
        {% if product.featured_media %}
          <img
            class="unikor-product-hero__main-img"
            src="{{ product.featured_media | image_url: width: 800 }}"
            alt="{{ product.featured_media.alt | default: product.title }}"
            width="800"
            height="{{ 800 | divided_by: product.featured_media.aspect_ratio | round }}"
            loading="eager"
          >
        {% else %}
          <div class="unikor-product-hero__img-placeholder"><span>Image du produit</span></div>
        {% endif %}
        <div class="unikor-product-hero__badge-overlay">GARANTIE<br>60 JOURS<br>REMBOURSÉ</div>
      </div>
      <div class="unikor-product-hero__as-seen">
        <span class="unikor-product-hero__as-seen-label">VU DANS :</span>
        <div class="unikor-product-hero__as-seen-logos">
          {% if section.settings.as_seen_logo_1 != blank %}
            <img src="{{ section.settings.as_seen_logo_1 | image_url: width: 80 }}" alt="" width="80" height="40">
          {% else %}
            <span class="unikor-product-hero__logo-placeholder">Parents</span>
          {% endif %}
          {% if section.settings.as_seen_logo_2 != blank %}
            <img src="{{ section.settings.as_seen_logo_2 | image_url: width: 80 }}" alt="" width="80" height="40">
          {% else %}
            <span class="unikor-product-hero__logo-placeholder">abc</span>
          {% endif %}
          {% if section.settings.as_seen_logo_3 != blank %}
            <img src="{{ section.settings.as_seen_logo_3 | image_url: width: 80 }}" alt="" width="80" height="40">
          {% else %}
            <span class="unikor-product-hero__logo-placeholder">WebMD</span>
          {% endif %}
        </div>
      </div>
      <div class="unikor-product-hero__thumbs-wrap">
        <button type="button" class="unikor-product-hero__thumb-arrow unikor-product-hero__thumb-arrow--prev" aria-label="Précédent">‹</button>
        <div class="unikor-product-hero__thumbs">
          {% if product.media.size > 0 %}
            {% for media in product.media limit: 5 %}
              <button type="button" class="unikor-product-hero__thumb{% if forloop.first %} is-active{% endif %}" data-full="{{ media | image_url: width: 800 }}" aria-label="Image {{ forloop.index }}">
                <img src="{{ media | image_url: width: 120 }}" alt="" width="60" height="60" loading="lazy">
              </button>
            {% endfor %}
          {% else %}
            <div class="unikor-product-hero__thumb-placeholder"><span>1</span></div>
          {% endif %}
        </div>
        <button type="button" class="unikor-product-hero__thumb-arrow unikor-product-hero__thumb-arrow--next" aria-label="Suivant">›</button>
      </div>
    </div>

    <div class="unikor-product-hero__info">
      <h1 class="unikor-product-hero__title">{{ section.settings.product_heading | default: product.title }}</h1>
      <div class="unikor-product-hero__reviews">
        <span class="unikor-product-hero__stars">★★★★★</span>
        <span class="unikor-product-hero__review-count">{{ section.settings.review_count | default: '1555' }} avis</span>
      </div>
      <div class="unikor-product-hero__price-row">
        {% if product.compare_at_price > product.price %}
          <span class="unikor-product-hero__compare-price">{{ product.compare_at_price | money }}</span>
        {% endif %}
        <span class="unikor-product-hero__price">{{ product.price | money }}</span>
        {% if product.compare_at_price > product.price %}
          {% assign save_pct = product.compare_at_price | minus: product.price | times: 100 | divided_by: product.compare_at_price %}
          <span class="unikor-product-hero__save-pill">ÉCONOMISEZ {{ save_pct }}%</span>
        {% endif %}
      </div>
      {% unless product.available %}
        <span class="unikor-product-hero__sold-out">Rupture de stock</span>
      {% endunless %}

      <ul class="unikor-product-hero__bullets">
        <li>Capteur doux et léger que les enfants remarquent à peine.</li>
        <li>Réveille votre enfant à la première goutte — pas toute la maison</li>
        <li>Méthode éprouvée pour des nuits au sec durablement — ou remboursé</li>
      </ul>

      <div class="unikor-product-hero__testimonial">
        {% if section.settings.testimonial_image != blank %}
          <img src="{{ section.settings.testimonial_image | image_url: width: 60 }}" alt="" class="unikor-product-hero__testimonial-avatar" width="60" height="60">
        {% else %}
          <div class="unikor-product-hero__testimonial-avatar-placeholder">AM</div>
        {% endif %}
        <div>
          <p class="unikor-product-hero__testimonial-quote">« Je pensais que mon enfant n'arrêterait jamais de faire pipi au lit. »</p>
          <p class="unikor-product-hero__testimonial-name">Amy M. ★★★★★</p>
        </div>
      </div>

      <p class="unikor-product-hero__note">
        <span class="unikor-product-hero__note-dot"></span> Offre limitée : tableau de récompenses et autocollants inclus gratuitement
      </p>

      <div class="unikor-product-hero__buy-more">
        <h4 class="unikor-product-hero__buy-more-title">Achetez plus et économisez</h4>
        <div class="unikor-product-hero__options">
          <label class="unikor-product-hero__option">
            <input type="radio" name="quantity_tier" value="1" checked>
            <span class="unikor-product-hero__option-label">Acheter 1 et économiser</span>
            <span class="unikor-product-hero__option-price">{{ product.price | money }}</span>
            <span class="unikor-product-hero__option-compare">{{ product.compare_at_price | default: product.price | money }}</span>
          </label>
          <label class="unikor-product-hero__option unikor-product-hero__option--popular">
            <input type="radio" name="quantity_tier" value="2">
            <span class="unikor-product-hero__option-label">Acheter 2 et économiser 12 %</span>
            <span class="unikor-product-hero__option-price">{% if product.compare_at_price %}{{ product.price | times: 0.88 | round | money }}{% else %}{{ product.price | money }}{% endif %}</span>
            <span class="unikor-product-hero__option-compare">{{ product.compare_at_price | default: product.price | money }}</span>
            <span class="unikor-product-hero__option-badge">Le plus populaire</span>
          </label>
          <label class="unikor-product-hero__option">
            <input type="radio" name="quantity_tier" value="3">
            <span class="unikor-product-hero__option-label">Acheter 3+ et économiser 20 %</span>
            <span class="unikor-product-hero__option-price">{% if product.compare_at_price %}{{ product.price | times: 0.8 | round | money }}{% else %}{{ product.price | money }}{% endif %}</span>
            <span class="unikor-product-hero__option-compare">{{ product.compare_at_price | default: product.price | money }}</span>
          </label>
        </div>
      </div>

      <p class="unikor-product-hero__setup">Support à l'installation pour réussir<br><small>Gratuit dès 2 alarmes commandées</small></p>

      {% form 'product', product, id: 'product-form-unikor', class: 'unikor-product-hero__form' %}
        <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
        <input type="hidden" name="return_to" value="/checkout">
        <button type="submit" name="add" class="unikor-product-hero__btn-buy" {% unless product.available %}disabled{% endunless %}>
          ACHETER
        </button>
      {% endform %}

      <div class="unikor-product-hero__payments">
        <span class="unikor-product-hero__payments-label">Shop Pay, G Pay, PayPal, Visa, Mastercard, American Express, Discover</span>
      </div>
    </div>
  </div>
</section>

<div class="unikor-sticky-bar" id="unikor-sticky-bar" aria-hidden="true">
  <span class="unikor-sticky-bar__text">Choisir les options</span>
  <a href="#product-form-unikor" class="unikor-sticky-bar__btn">ACHETER</a>
</div>
<script>
  (function(){
    var bar = document.getElementById('unikor-sticky-bar');
    var form = document.getElementById('product-form-unikor');
    if (!bar || !form) return;
    var obs = new IntersectionObserver(function(entries){
      entries.forEach(function(e){
        bar.setAttribute('aria-hidden', e.isIntersecting ? 'true' : 'false');
        bar.style.display = e.isIntersecting ? 'none' : 'flex';
      });
    }, { rootMargin: '-80px 0 0 0', threshold: 0 });
    obs.observe(form);
  })();
  document.querySelectorAll('.unikor-product-hero__thumb').forEach(function(btn){
    btn.addEventListener('click', function(){
      var main = document.querySelector('.unikor-product-hero__main-img');
      var full = this.getAttribute('data-full');
      if (main && full) main.src = full;
      document.querySelectorAll('.unikor-product-hero__thumb').forEach(function(b){ b.classList.remove('is-active'); });
      this.classList.add('is-active');
    });
  });
</script>

{% schema %}
{
  "name": "Product hero (Unikor)",
  "class": "section-product-hero-unikor",
  "tag": "section",
  "settings": [
    { "type": "text", "id": "product_heading", "label": "Product name (heading)", "default": "NightGuard Bedwetting Alarm" },
    { "type": "text", "id": "review_count", "label": "Review count", "default": "1555" },
    { "type": "image_picker", "id": "testimonial_image", "label": "Testimonial avatar" },
    { "type": "image_picker", "id": "as_seen_logo_1", "label": "As seen on logo 1" },
    { "type": "image_picker", "id": "as_seen_logo_2", "label": "As seen on logo 2" },
    { "type": "image_picker", "id": "as_seen_logo_3", "label": "As seen on logo 3" }
  ]
}
{% endschema %}
